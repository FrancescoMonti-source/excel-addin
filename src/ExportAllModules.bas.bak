Attribute VB_Name = "ExportAllModules"
Sub ExportAllModules()
    Dim vbcomp As Object
    Dim folder As String, ext As String

    ' Export to: %USERPROFILE%\Documents\VBA_Export\
    folder = Environ$("USERPROFILE") & "\Documents\VBA_Export\"
    If Dir(folder, vbDirectory) = vbNullString Then MkDir folder

    For Each vbcomp In ThisWorkbook.VBProject.VBComponents
        ' 100 = document modules (ThisWorkbook/sheets) – skip them
        If vbcomp.Type <> 100 Then
            Select Case vbcomp.Type
                Case 1: ext = ".bas"
                Case 2: ext = ".cls"
                Case 3: ext = ".frm"
                Case Else: ext = ".txt"
            End Select
            vbcomp.Export folder & vbcomp.Name & ext
        End If
    Next vbcomp

    MsgBox "Exported to: " & folder, vbInformation
End Sub

